# Zigbee Water Meter (MuseLab C6_WATER_V2) ‚öôÔ∏èüíß

**Licensed under GPLv3 ‚Äî see `LICENSE`.**

**–ö—Ä–∞—Ç–∫–æ:** –ø—Ä–æ—à–∏–≤–∫–∞ ESP-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è Zigbee (–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä) –¥–ª—è –¥–≤—É—Ö–∫–∞–Ω–∞–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç—á–∏–∫–∞ –≤–æ–¥—ã (—Ö–æ–ª–æ–¥–Ω–∞—è/–≥–æ—Ä—è—á–∞—è). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è (m¬≥), –æ—Ñ—Ñ—Å–µ—Ç—ã, —Å–µ—Ä–∏–π–Ω–∏–∫–∏ –∏ –æ—Ç—á—ë—Ç –±–∞—Ç–∞—Ä–µ–∏.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è üìÅ
- `main/main.ino` ‚Äî –∏—Å—Ö–æ–¥–Ω–∏–∫ –ø—Ä–æ—à–∏–≤–∫–∏ –¥–ª—è ESP (Zigbee End Device). üîß
  –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞: `MODEL_ID`, `MANUFACTURER_NAME`, –ø–∏–Ω—ã (`RGB_LED_PIN`, `PULSE_COLD_PIN`, `PULSE_HOT_PIN`), `TX_POWER`, `SIMULATION_MODE`.
- `water_meter_converter.js` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è `zigbee-herdsman-converters` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Zigbee2MQTT / Home Assistant). üîå
- `assets/z2m_view.png` ‚Äî —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Zigbee2MQTT. üì∏
- `LICENSE` ‚Äî GPLv3.

---

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç üéØ
- –≠–º—É–ª–∏—Ä—É–µ—Ç –¥–≤—É—Ö–∫–∞–Ω–∞–ª—å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ –≤–æ–¥—ã (Endpoint 1 ‚Äî —Ö–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞, Endpoint 2 ‚Äî –≥–æ—Ä—è—á–∞—è).
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—É–º–º–∞—Ä–Ω—ã–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è –≤ –ª–∏—Ç—Ä–∞—Ö/–∫—É–±.–º–µ—Ç—Ä–∞—Ö (`water_total_1`, `water_total_2` ‚Äî –µ–¥–∏–Ω–∏—Ü—ã –≤ m¬≥).
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞–≤–∞—Ç—å –æ—Ñ—Ñ—Å–µ—Ç (`offset_1`, `offset_2`) –≤ –º¬≥ (–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∫—É–±. –º–µ—Ç—Ä—ã –≤ –ª–∏—Ç—Ä—ã –¥–ª—è –ø—Ä–æ—à–∏–≤–∫–∏).
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø–∏—Å–∏/—á—Ç–µ–Ω–∏—è —Å–µ—Ä–∏–π–Ω–∏–∫–∞ (`serial_1`, `serial_2`) –∏ –æ—Ç—á—ë—Ç –±–∞—Ç–∞—Ä–µ–∏ (—á–µ—Ä–µ–∑ endpoint 1).

---

## –ë—ã—Å—Ç—Ä–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ üîó

### –ü—Ä–æ—à–∏–≤–∫–∞ (`main/main.ino`)
1. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –ø—Ä–æ—à–µ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ ESP32 —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Zigbee (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ESP-IDF/PlatformIO —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ Zigbee).  
2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –≤ `main/main.ino` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–ø–∏–Ω—ã, `MODEL_ID`, `TX_POWER` –∏ —Ç.–¥.) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.  
3. –ü–æ—Å–ª–µ –ø—Ä–æ—à–∏–≤–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ Zigbee End Device —Å –¥–≤—É–º—è endpoint'–∞–º–∏.

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ESP Zigbee stack –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ API; –≤—ã–±–∏—Ä–∞–π—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–±–æ—Ä–∫–∏ (ESP-IDF/PlatformIO —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏).

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ –≤ Zigbee2MQTT / Home Assistant
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `water_meter_converter.js` –≤ –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ `zigbee-herdsman-converters/devices` (–∏–ª–∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–∞—à–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–æ–≤).
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Zigbee2MQTT/HA, —á—Ç–æ–±—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª–æ—Å—å –∫–∞–∫ `C6_WATER_V2` (vendor: MuseLab).
3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ñ—Ñ—Å–µ—Ç–æ–º: –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è `offset_1` / `offset_2` –≤ –º¬≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä `1.500`), –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –ø–µ—Ä–µ–≤–µ–¥—ë—Ç –≤ –ª–∏—Ç—Ä—ã –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.

---

## –ü—Ä–∏–º–µ—Ä—ã —Å–≤–æ–π—Å—Ç–≤ (–∫–∞–∫ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ Zigbee2MQTT) üîç
- `water_total_1` / `water_total_2` ‚Äî –∏—Ç–æ–≥, —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–µ–¥–∏–Ω–∏—Ü–∞: **m¬≥**)  
- `offset_1` / `offset_2` ‚Äî –æ—Ñ—Ñ—Å–µ—Ç (–∏–∑–º–µ–Ω—è–µ–º–æ–µ, **m¬≥**)  
- `serial_1` / `serial_2` ‚Äî —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞  
- `battery` ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –±–∞—Ç–∞—Ä–µ–∏ (–æ—Ç—á—ë—Ç —Å endpoint 1)

---

## –í–∫–ª–∞–¥ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ ‚ú®
- –ü–æ–∂–µ–ª–∞–Ω–∏—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ issue –∏–ª–∏ PR.  
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–≥—É –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç—É–ª—á–µ–π–Ω (ESP-IDF / PlatformIO) ‚Äî —Å–∫–∞–∂–∏—Ç–µ, –∫–∞–∫–æ–π –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ.

---

## –õ–∏—Ü–µ–Ω–∑–∏—è üìù
–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ **GPLv3**. –°–º. —Ñ–∞–π–ª `LICENSE` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–≥—É —Ç–∞–∫–∂–µ:
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Zigbee2MQTT;  
- –î–æ–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ (PlatformIO/ESP-IDF) —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏. üí°
